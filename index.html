<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Radar Command</title>

<style>
* { box-sizing: border-box; }

body {
  margin: 0;
  font-family: monospace;
  background: #111;
  color: #d0d0d0;
  overflow: hidden;
}

/* ================= TOP BAR ================= */

#topbar {
  height: 36px;
  background: #2b2b2b;
  border-bottom: 1px solid #444;
  display: flex;
  align-items: center;
  padding: 0 10px;
  font-size: 12px;
}

#logo {
  font-weight: bold;
  color: #9fdcff;
}

#topbar-right {
  margin-left: auto;
  display: flex;
  gap: 15px;
}

/* ================= LAYOUT ================= */

#container {
  display: flex;
  height: calc(100vh - 36px);
}

/* ================= CENTER ================= */

#center {
  flex: 1;
  display: flex;
  flex-direction: column;
}

#mainView {
  flex: 1;
  background: #050a0d;
}

canvas {
  width: 100%;
  height: 100%;
  background: #050a0d;
}

/* ================= BOTTOM ================= */

#bottombar {
  height: 40px;
  background: #2b2b2b;
  border-top: 1px solid #444;
  display: flex;
  align-items: center;
  padding: 0 10px;
  font-size: 12px;
}

/* ================= RIGHT PANEL ================= */

#rightbar {
  width: 260px;
  background: #2f2f2f;
  border-left: 1px solid #444;
}

.panel {
  border-bottom: 1px solid #444;
  padding: 8px;
  font-size: 12px;
}

.panel h3 {
  margin: 0 0 6px;
  font-size: 12px;
  color: #fff;
  border-bottom: 1px solid #555;
  padding-bottom: 4px;
}

.value { color: #9fdcff; }
.muted { color: #888; }
.base { color: #ff6666; }

</style>
</head>

<body>

<div id="topbar">
  <div id="logo">RADAR CMD</div>
  <div id="topbar-right">
    <div id="zulu">Zulu: --:--:--</div>
    <div id="local">Local: --:--:--</div>
    <div id="zoomInfo">Zoom: 100%</div>
  </div>
</div>

<div id="container">

  <div id="center">
    <div id="mainView">
      <canvas id="radar"></canvas>
    </div>
    <div id="bottombar">
      Scroll to Zoom In | Click Aircraft to Select
    </div>
  </div>

  <div id="rightbar">
    <div class="panel">
      <h3>UNIT STATUS</h3>
      <div id="unitInfo" class="muted">
        Please Select A Designated Unit.
      </div>
    </div>
  </div>

</div>

<script>
/* ================= TIME ================= */

function updateTime() {
  const now = new Date();
  document.getElementById("local").textContent =
    "Local: " + now.toLocaleTimeString();
  document.getElementById("zulu").textContent =
    "Zulu: " + now.toUTCString().slice(17, 25);
}
setInterval(updateTime, 1000);
updateTime();

/* ================= CANVAS ================= */

const canvas = document.getElementById("radar");
const ctx = canvas.getContext("2d");

function resize() {
  canvas.width = canvas.clientWidth;
  canvas.height = canvas.clientHeight;
}
window.addEventListener("resize", resize);
resize();

/* ================= ZOOM (100%+) ================= */

let zoom = 1;

canvas.addEventListener("wheel", e => {
  e.preventDefault();
  zoom += e.deltaY * -0.001;
  zoom = Math.min(Math.max(zoom, 1), 3);
  document.getElementById("zoomInfo").textContent =
    "Zoom: " + Math.round(zoom * 100) + "%";
});

/* ================= MAP IMAGE ================= */

const mapImg = new Image();
mapImg.src = "map.png";

let landPixels = [];
let bases = [];

mapImg.onload = () => {
  detectLand();
  placeBases();
};

/* detect non-transparent pixels */
function detectLand() {
  const temp = document.createElement("canvas");
  temp.width = mapImg.width;
  temp.height = mapImg.height;
  const tctx = temp.getContext("2d");
  tctx.drawImage(mapImg, 0, 0);

  const img = tctx.getImageData(0, 0, temp.width, temp.height).data;

  landPixels = [];
  for (let y = 0; y < temp.height; y += 4) {
    for (let x = 0; x < temp.width; x += 4) {
      const a = img[(y * temp.width + x) * 4 + 3];
      if (a > 0) landPixels.push({ x, y });
    }
  }
}

/* random bases on land */
function placeBases() {
  bases = [];
  for (let i = 0; i < 3; i++) {
    bases.push(landPixels[Math.floor(Math.random() * landPixels.length)]);
  }
}

/* ================= AIRCRAFT ================= */

const aircraft = [];
let selected = null;

function spawnAircraft() {
  return {
    x: Math.random() * canvas.width,
    y: Math.random() * canvas.height,
    vx: (Math.random() - 0.5) * 1.2,
    vy: (Math.random() - 0.5) * 1.2,
    altitude: Math.floor(8000 + Math.random() * 25000),
    speed: Math.floor(250 + Math.random() * 250),
    type: Math.random() > 0.5 ? "Civilian" : "Military"
  };
}

for (let i = 0; i < 10; i++) aircraft.push(spawnAircraft());

/* ================= LOOP ================= */

function loop() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  const w = canvas.width * zoom;
  const h = canvas.height * zoom;
  ctx.drawImage(mapImg, (canvas.width - w) / 2, (canvas.height - h) / 2, w, h);

  /* draw bases */
  bases.forEach(b => {
    const x = (b.x / mapImg.width) * w + (canvas.width - w) / 2;
    const y = (b.y / mapImg.height) * h + (canvas.height - h) / 2;
    ctx.fillStyle = "#ff5555";
    ctx.fillRect(x - 3, y - 3, 6, 6);
  });

  /* aircraft random walk */
  aircraft.forEach(a => {
    if (Math.random() < 0.03) {
      a.vx += (Math.random() - 0.5) * 0.4;
      a.vy += (Math.random() - 0.5) * 0.4;
    }

    a.x += a.vx;
    a.y += a.vy;

    if (a.x < 0) a.x = canvas.width;
    if (a.y < 0) a.y = canvas.height;
    if (a.x > canvas.width) a.x = 0;
    if (a.y > canvas.height) a.y = 0;

    const dx = canvas.width / 2 + (a.x - canvas.width / 2) * zoom;
    const dy = canvas.height / 2 + (a.y - canvas.height / 2) * zoom;

    ctx.beginPath();
    ctx.arc(dx, dy, 4, 0, Math.PI * 2);
    ctx.fillStyle = a === selected ? "#ffcc00" : "#7fdcff";
    ctx.fill();
  });

  requestAnimationFrame(loop);
}

loop();
</script>

</body>
</html>
